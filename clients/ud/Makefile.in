# $OpenLDAP$

SRCS=	main.c find.c mod.c print.c auth.c util.c help.c \
	string_to_key.c group.c edit.c globals.c
XSRCS= version.c
OBJS=	main.o find.o mod.o print.o auth.o util.o help.o \
	string_to_key.o group.o globals.o edit.o
HDRS=	ud.h
PROGRAMS= ud

LDAP_INCDIR= ../../include       
LDAP_LIBDIR= ../../libraries

NT_DYN_DEFS = -DLBER_DECL=dllimport -DLDAP_DECL=dllimport
CPPFLAGS = $(@PLAT@_@LIB_LINKAGE@_DEFS)

XLIBS =  -llutil -lldif -lldap -llber
XXLIBS	= $(TERMCAP_LIBS) $(SECURITY_LIBS) $(LUTIL_LIBS)

ud : version.o
	$(LTLINK) -o $@ version.o $(OBJS) $(LIBS)

version.c: ${OBJS} $(LDAP_LIBDEPEND)
	@-$(RM) $@
	$(MKVERSION) -s -c -n Version UserDirectory > $@

install-local: FORCE
	-$(MKDIR) $(DESTDIR)$(bindir)
	-mv -f $(DESTDIR)$(bindir)/ud $(DESTDIR)$(bindir)/ud-
	@(								\
	    for prg in $(PROGRAMS); do					\
		$(LTINSTALL) $(INSTALLFLAGS) -s -m 755 $$prg$(EXEEXT)	\
		    $(DESTDIR)$(bindir);				\
	    done							\
	)

